# SingleThread Consumer 처리량 테스트

## 테스트 개요

### 목적
싱글 스레드 Consumer 성능을 측정하여 멀티스레드 Consumer 성능과 비교

### 테스트 환경
- **Partitions**: 1개 (단일 파티션)
- **Consumer Threads**: 1개 (Single Thread)
- **Processing Mode**: 순차 처리

## 측정 대상 메트릭

### 1. 처리량
- TPS : 초당 처리 메시지 수
- 총 처리 메시지 수: 테스트 기간 동안 처리된 전체 메시지 수

### 2. 지연시간
- 평균 처리 시간: 메시지당 평균 처리 소요 시간 (ms)
- 총 처리 시간: 전체 메시지 처리에 소요된 시간 (ms)

### 3. 안정성
- 메시지 손실률: 전송 vs 처리 메시지 수 비교
- 에러율: 처리 실패한 메시지 비율

## 테스트 시나리오

### 시나리오 1: 기본 처리량 테스트
#### 목표: 주문 발생시 처리 성능 측정

**설정**:
- 메시지 수: 1,000개
- 메시지 크기: 평균 500 bytes
- 처리 시간: 10ms per message
- 측정 시간: 전체 처리 완료까지

**결과**:
```
=== SingleThread 기본처리량 테스트 Performance Stats ===
메시지 수: 1000
총 실행 시간: 12103 ms
평균 실행 시간:12.103 ms
TPS: 66.66666666666667
```

### 시나리오 2: 부하 테스트
#### 목표: 높은 부하에서의 성능 한계 확인

**설정**:
- 메시지 수: 10,000개
- 메시지 크기: 평균 500 bytes
- 처리 시간: 10ms per message
- 측정 시간: 전체 처리 완료까지

**결과**:
```
1분간 실행 결과
=== SingleThread 부하처리량 테스트 ===
메시지 수: 6330
전체 실행 시간: 76198 ms
평균 실행 시간: 12.037598736176935 ms
TPS: 80.12658227848101

완료될 떄 까지 실행 결과
=== SingleThread 부하처리량 테스트 ===
메시지 수: 10000
전체 실행 시간: 120466 ms
평균 실행 시간: 12.0466 ms
TPS: 81.30081300813008
```

### 시나리오 3: 가변 메시지 크기 테스트
#### 목표: 메시지 크기가 성능에 미치는 영향 분석

**설정**:
- 메시지 수: 1,000개
- 메시지 크기: 100bytes ~ 2KB
- 처리 시간: 10ms per message
- 측정 시간: 전체 처리 완료까지

**결과**:
```
=== SingleThread 가변메시지 처리량 테스트 ===
메시지 수: 1000
전체 실행 시간: 12134 ms
평균 실행 시간: 12.134 ms
TPS: 66.66666666666667
```

## 🔧 테스트 실행 방법

### 1. 테스트 환경 설정
```bash
# Kafka 서버 시작
docker-compose up -d

# 토픽 생성 (Spring 서버 실행 시 자동 생성)
kafka-topics.sh --create --topic order-topic --partitions 1 --replication-factor 1 --bootstrap-server localhost:9092

### 2. 테스트 실행
```java
@Test
@DisplayName("시나리오1: 기본 처리량 테스트")
void 기본_처리량_테스트() {
    // 1. Producer로 테스트 메시지 전송
    // 2. SingleThreadConsumerExecutor 시작
    // 3. 모든 메시지 처리 대기
    // 4. 성능 메트릭 수집 및 검증
}
```
